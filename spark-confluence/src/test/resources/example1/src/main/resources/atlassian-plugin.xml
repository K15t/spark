<atlassian-plugin key="${project.groupId}.${project.artifactId}" name="${project.name}" plugins-version="2">
    <plugin-info>
        <description>${project.description}</description>
        <version>${project.version}</version>
        <vendor name="${project.organization.name}" url="${project.organization.url}" />
    </plugin-info>

    <!-- === Admin App ========================= -->

    <servlet name="Admin App Servlet" key="admin-app-servlet" class="com.k15t.spark.confluence.ConfluenceAppServlet">
        <description>Outputs the 'Hello World' SPARK admin app.</description>
        <url-pattern>/admin-app*</url-pattern>
        <init-param>
            <!-- This is the path in your resource directory where the angularjs application lives -->
            <param-name>resource-path</param-name>
            <param-value>/spark/admin_app</param-value>
        </init-param>
    </servlet>

    <web-item name="Admin App Web-Item" key="spark-admin-app-webitem" section="system.admin/configuration" weight="10">
        <description>Adds a menu entry for the Admin App SPARK app to the admin console.</description>

        <label>Admin App</label>
        <link linkId="spark-admin-app-webitem">/plugins/servlet/admin-app</link>
    </web-item>



    <!-- === Space App ========================= -->

    <servlet name="Space App Servlet" key="space-app-servlet" class="com.k15t.spark.confluence.ConfluenceAppServlet">
        <description>Outputs the 'Hello World' SPARK space app.</description>
        <url-pattern>/space-app*</url-pattern>
        <init-param>
            <!-- This is the path in your resource directory where the angularjs application lives -->
            <param-name>resource-path</param-name>
            <param-value>/spark/space_app</param-value>
        </init-param>
    </servlet>

    <xwork key="space-app-actions">
        <package name="Space App Action" extends="default" namespace="/spaces/space-app">
            <default-interceptor-ref name="defaultStack"/>
            <action name="index" class="com.k15t.spark.confluence.ConfluenceSpaceAppAction" method="index">
                <result name="input" type="velocity">/com/k15t/spark/confluence/space-app.vm</result>
                <result name="notpermitted" type="redirect">/pages/pagenotpermitted.action</result>
                <param name="resource-path">/spark/space_app</param>
            </action>
        </package>
    </xwork>



    <!-- === Dialog App ========================= -->

    <servlet name="Dialog App 1.3 SPARK App Servlet" key="spark-dialog-app13-servlet" class="com.k15t.spark.confluence.ConfluenceAppServlet">
        <description>Outputs the resources for the Dialog App 1.3 SPARK app.</description>
        <url-pattern>/dialog-app13*</url-pattern>
        <init-param>
            <param-name>resource-path</param-name>
            <param-value>/spark/dialog-app_v13</param-value>
        </init-param>
    </servlet>

    <web-item name="Dialog App 1.3 SPARK App Web-Item" key="spark-dialog-app13-webitem" section="system.content.action" weight="200">
        <description>Adds a menu entry for the Dialog App 1.3 SPARK app to the tools menu.</description>

        <label>Dialog App 1.3</label>
        <link linkId="spark-dialog-app13-webitem">#</link>
    </web-item>

    <web-resource name="Dialog App Bootstrap" key="dialog-app-web-resource">
        <description>Hooks in the Viewport Controller (in the Confluence UI).</description>

        <context>page</context>
        <context>blogpost</context>

        <resource type="download" name="lazyload.js" location="com/k15t/spark/confluence/angular1x/lazyload.js"/>
        <resource type="download" name="dialog-app.css" location="com/k15t/spark/confluence/angular1x/dialog-app.css"/>
        <resource type="download" name="spark-dialog-app-bootstrap.soy.js" location="com/k15t/spark/confluence/angular1x/dialog-app-bootstrap.soy"/>
        <resource type="download" name="spark-dialog-app-bootstrap.js" location="com/k15t/spark/confluence/angular1x/dialog-app-bootstrap.js"/>
        <resource type="download" name="dialog-apps.js" location="spark/dialog-apps.js"/>

        <transformation extension="soy">
            <transformer key="soyTransformer">
                <functions>com.atlassian.confluence.plugins.soy:soy-core-functions</functions>
            </transformer>
        </transformation>
    </web-resource>

    <servlet name="Dialog App 1.4 SPARK App Servlet" key="spark-dialog-app14-servlet" class="com.k15t.spark.confluence.ConfluenceAppServlet">
        <description>Outputs the resources for the Dialog App 1.4 SPARK app.</description>
        <url-pattern>/dialog-app14*</url-pattern>
        <init-param>
            <param-name>resource-path</param-name>
            <param-value>/spark/dialog-app_v14</param-value>
        </init-param>
    </servlet>

    <web-item name="Dialog App 1.4 SPARK App Web-Item" key="spark-dialog-app14-webitem" section="system.content.action" weight="200">
        <description>Adds a menu entry for the Dialog App 1.4 SPARK app to the tools menu.</description>

        <label>Dialog App 1.4</label>
        <link linkId="spark-dialog-app14-webitem">#</link>
    </web-item>

</atlassian-plugin>
